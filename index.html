<!DOCTYPE html>
<html>
<head>
    <meta charset="utf8">
    <title>Particle Wipe Generator</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="script.js"></script>
</head>
<body>
    <h1>Particle wipe generator</h1>
    <p>It's faster to try it out than to read an explanation.  Click "Generate", then hit the play button at the bottom!</p>
    <div id="generator">
        <div class="generation">
            <div class="particle">
                <figure>
                    <canvas id="particle-canvas" width="256" height="256"></canvas>
                    <figcaption>Particle (256√ó256)</figcaption>
                </figure>
                <ul class="particle-presets">
                    <li><button class="control-preset-particle" value="diamond">‚óÜ</button></li>
                    <li><button class="control-preset-particle" value="circle">‚óè</button></li>
                    <li><button class="control-preset-particle" value="heart">‚ô•Ô∏è</button></li>
                    <li><button class="control-preset-particle" value="star">‚òÖ</button></li>
                    <li><button class="control-preset-particle" value="text">üî£</button></li>
                </ul>
            </div>
            <div class="generator-controls">
                <dl class="control-grid">
                    <dt><label for="control-rows">Rows</label></dt>
                    <dd><input id="control-rows" type="range" min="1" max="32" value="18"></dd>

                    <dt><label for="control-cols">Columns</label></dt>
                    <dd><input id="control-cols" type="range" min="1" max="64" value="32"></dd>

                    <dt><label for="control-delay">Delay</label></dt>
                    <dd><input id="control-delay" type="range" min="0" max="1" step="0.0625" value="0.0625"></dd>

                    <dt><label for="control-pattern">Pattern</label></dt>
                    <dd>
                        <select id="control-pattern">
                            <option value="wipe">wipe</option>
                            <option value="curtain">curtain</option>
                            <option value="shutter">shutter</option>
                            <option value="diamond">diamond</option>
                            <option value="box">box</option>
                            <option value="spiral">spiral</option>
                            <option value="random">random</option>
                            <!-- density? -->
                        </select>
                    </dd>

                    <!-- Optional pattern settings -->
                    <dt><label for="control-direction">Direction</label></dt>
                    <dd>
                        <select id="control-direction">
                            <option value="row">by row</option>
                            <option value="column">by column</option>
                            <option value="diagonal">diagonally</option>
                        </select>
                    </dd>

                    <dt><label for="control-angle">Angle</label></dt>
                    <dd><input id="control-angle" type="range" min="0" max="1" value="0" step="0.01"></dd>

                    <dt><label for="control-droop">Droop</label></dt>
                    <dd><input id="control-droop" type="range" min="0" max="1" value="0" step="0.01"></dd>

                    <dt><label for="control-fill-delay">Fill delay</label></dt>
                    <dd><input id="control-fill-delay" type="range" min="1" max="10" value="3" step="0.25"></dd>

                    <dt><label for="control-loops">Loops</label></dt>
                    <dd><input id="control-loops" type="range" min="0.25" max="8" value="1" step="0.25"></dd>

                    <dt><label for="control-arms">Arms</label></dt>
                    <dd><input id="control-arms" type="range" min="1" max="8" value="1" step="1"></dd>

                    <!-- Generic pattern settings -->
                    <dt><label for="control-interlace">Interlace</label></dt>
                    <dd><input id="control-interlace" type="range" min="1" max="8" value="1"></dd>
                </dl>

                <div class="generation-checkboxes">
                    <label title="Reflect pattern"><input id="control-reflect" type="checkbox"> ‚áî Reflect</label>
                    <label title="Reverse cell order"><input id="control-reverse" type="checkbox"> ‚áê Reverse</label>
                    <label title="Mirror horizontally"><input id="control-mirror" type="checkbox"> ‚Üî Mirror</label>
                    <label title="Flip vertically"><input id="control-flip" type="checkbox"> ‚Üï Flip</label>
                </div>
            </div>
            <div class="preview-generate">
                <figure>
                    <canvas id="preview" width="384" height="216"></canvas>
                    <figcaption>Preview</figcaption>
                </figure>
                <button id="control-generate">Generate</button>
            </div>
        </div>
        <div class="playback">
            <div class="main-canvas">
                <figure>
                    <canvas id="canvas" width="1280" height="720"></canvas>
                    <figcaption>
                        <p>Result in action</p>
                        <label>
                            <input id="knob-use-halo" type="checkbox" checked>
                            Use halo
                        </label>
                        <input id="knob-halo-color" type="color" value="#ff89b2">
                    </figcaption>
                </figure>
                <p class="playback-controls">
                    <button id="knob-play">‚ñ∂Ô∏è</button>
                    <!--
                    FIXME how does "pingpong" actually work?  does it implicitly scale the time bar by two?  use some hidden thing to track whether we're going forwards or backwards??
                    <select id="knob-play-mode">
                        <option>normal</option>
                        <option>switch before/after</option>
                        <option>ping-pong</option>
                    </select>
                    -->
                    <label>
                        <input id="knob-play-loop" type="checkbox">
                        Loop
                    </label>
                    <input id="knob-progress" type="range" min="0" max="1" step="any" value="0">
                </p>
                <div class="other-playback-controls">
                    <p>Total playback time: <output id="knob-duration-value">0.25 seconds / 15 frames</output></p>
                    <input id="knob-duration" type="range" min="1" max="600" value="120">
                    <p>Ramp (length of gradient between before/after): <output id="knob-ramp-value">4/256</output></p>
                    <input id="knob-ramp" type="range" min="1" max="256" value="4">
                </div>
            </div>
            <div class="parts">
                <figure>
                    <canvas id="before-canvas" width="1280" height="720"></canvas>
                    <figcaption>Before <input id="before-color" type="color" value="#ff8000"></figcaption>
                </figure>
                <figure>
                    <canvas id="mask-canvas" width="1280" height="720"></canvas>
                    <figcaption>Generated mask</figcaption>
                </figure>
                <figure>
                    <canvas id="after-canvas" width="1280" height="720"></canvas>
                    <figcaption>After <input id="after-color" type="color" value="#00ff80"></figcaption>
                </figure>
            </div>
        </div>
    </div>
    <!--
    <p>Careful!  There are only 256 possible gray values, so there can only be 256 "steps" in the animation.  A large column delay, or a long duration, will spread the steps out and cause visible ringing.</p>
    <p>Also!  The algorithm this uses is very precise, <em>but</em> assumes that the particle will never need to grow bigger than three times the size of a cell.  If your particle isn't solid in the middle, or you have especially long delays, you may get weird results.</p>
    -->
</body>
</html>
